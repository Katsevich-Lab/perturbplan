<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute power analysis for experimental planning (underspecified design) — compute_power_plan • perturbplan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute power analysis for experimental planning (underspecified design) — compute_power_plan"><meta name="description" content="This function performs power analysis during the experimental planning phase using
underspecified information. It accepts aggregate experimental parameters (cells per
target, reads per cell) without requiring specific cell count assignments to individual
gRNAs or perturbation-gene pairs. It also allows specifying a list of experimental parameters to compare across.
This is useful for designing experiments before data
collection, allowing you to explore how different experimental designs (cell numbers,
sequencing depth) affect overall statistical power."><meta property="og:description" content="This function performs power analysis during the experimental planning phase using
underspecified information. It accepts aggregate experimental parameters (cells per
target, reads per cell) without requiring specific cell count assignments to individual
gRNAs or perturbation-gene pairs. It also allows specifying a list of experimental parameters to compare across.
This is useful for designing experiments before data
collection, allowing you to explore how different experimental designs (cell numbers,
sequencing depth) affect overall statistical power."><meta property="og:image" content="https://katsevich-lab.github.io/perturbplan/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">perturbplan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/preprocess-reference.html">Prepare Data For Web App</a></li>
    <li><a class="dropdown-item" href="../articles/prospective-power.html">Prospective Power Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/posthoc.html">Retrospective Power Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://katsevich-lab-perturbplan.share.connect.posit.cloud/"><span class="fa fa-external-link-alt"></span> Web App</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Katsevich-Lab/perturbplan" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute power analysis for experimental planning (underspecified design)</h1>

      <div class="d-none name"><code>compute_power_plan.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs power analysis during the experimental planning phase using
underspecified information. It accepts aggregate experimental parameters (cells per
target, reads per cell) without requiring specific cell count assignments to individual
gRNAs or perturbation-gene pairs. It also allows specifying a list of experimental parameters to compare across.
This is useful for designing experiments before data
collection, allowing you to explore how different experimental designs (cell numbers,
sequencing depth) affect overall statistical power.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_power_plan</span><span class="op">(</span></span>
<span>  <span class="va">TPM_threshold</span>,</span>
<span>  <span class="va">minimum_fold_change</span>,</span>
<span>  <span class="va">cells_per_target</span>,</span>
<span>  <span class="va">sequenced_reads_per_cell</span>,</span>
<span>  MOI <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  num_targets <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  non_targeting_gRNAs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  gRNAs_per_target <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  gRNA_variability <span class="op">=</span> <span class="fl">0.13</span>,</span>
<span>  control_group <span class="op">=</span> <span class="st">"complement"</span>,</span>
<span>  side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  multiple_testing_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  prop_non_null <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">baseline_expression_stats</span>,</span>
<span>  <span class="va">library_parameters</span>,</span>
<span>  grid_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min_power_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  max_power_threshold <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  mapping_efficiency <span class="op">=</span> <span class="fl">0.72</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tpm-threshold">TPM_threshold<a class="anchor" aria-label="anchor" href="#arg-tpm-threshold"></a></dt>
<dd><p>Numeric, numeric vector, or character. TPM threshold value, custom sequence, or "varying" for auto-selection.</p></dd>


<dt id="arg-minimum-fold-change">minimum_fold_change<a class="anchor" aria-label="anchor" href="#arg-minimum-fold-change"></a></dt>
<dd><p>Numeric, numeric vector, or character. Minimum fold change value, custom sequence, or "varying" for auto-selection.
Pairs with effects at least this large are considered non-null.</p></dd>


<dt id="arg-cells-per-target">cells_per_target<a class="anchor" aria-label="anchor" href="#arg-cells-per-target"></a></dt>
<dd><p>Numeric, numeric vector, or character. Number of cells per target, custom sequence, or "varying" for auto-generated grid.</p></dd>


<dt id="arg-sequenced-reads-per-cell">sequenced_reads_per_cell<a class="anchor" aria-label="anchor" href="#arg-sequenced-reads-per-cell"></a></dt>
<dd><p>Numeric, numeric vector, or character. Sequenced reads per cell (raw sequencer output), custom sequence, or "varying" for auto-generated grid.</p></dd>


<dt id="arg-moi">MOI<a class="anchor" aria-label="anchor" href="#arg-moi"></a></dt>
<dd><p>Numeric. Multiplicity of infection (default: 10).</p></dd>


<dt id="arg-num-targets">num_targets<a class="anchor" aria-label="anchor" href="#arg-num-targets"></a></dt>
<dd><p>Integer. Number of targets (default: 100).</p></dd>


<dt id="arg-non-targeting-grnas">non_targeting_gRNAs<a class="anchor" aria-label="anchor" href="#arg-non-targeting-grnas"></a></dt>
<dd><p>Integer. Number of non-targeting gRNAs (default: 10).</p></dd>


<dt id="arg-grnas-per-target">gRNAs_per_target<a class="anchor" aria-label="anchor" href="#arg-grnas-per-target"></a></dt>
<dd><p>Integer. Number of gRNAs per target (default: 4).</p></dd>


<dt id="arg-grna-variability">gRNA_variability<a class="anchor" aria-label="anchor" href="#arg-grna-variability"></a></dt>
<dd><p>Numeric. Standard deviation for gRNA effect variation (default: 0.13).</p></dd>


<dt id="arg-control-group">control_group<a class="anchor" aria-label="anchor" href="#arg-control-group"></a></dt>
<dd><p>String. Control group type (default: "complement").</p></dd>


<dt id="arg-side">side<a class="anchor" aria-label="anchor" href="#arg-side"></a></dt>
<dd><p>String. Test sidedness (default: "left").</p></dd>


<dt id="arg-multiple-testing-alpha">multiple_testing_alpha<a class="anchor" aria-label="anchor" href="#arg-multiple-testing-alpha"></a></dt>
<dd><p>Numeric. FDR level (default: 0.05).</p></dd>


<dt id="arg-prop-non-null">prop_non_null<a class="anchor" aria-label="anchor" href="#arg-prop-non-null"></a></dt>
<dd><p>Numeric. Proportion of non-null hypotheses,
i.e., the fraction of tested pairs expected to exhibit an effect
at least as large as the specified minimum_fold_change (default: 0.1).</p></dd>


<dt id="arg-baseline-expression-stats">baseline_expression_stats<a class="anchor" aria-label="anchor" href="#arg-baseline-expression-stats"></a></dt>
<dd><p>Data frame. Baseline expression statistics.
See <code><a href="reference_data_processing.html">reference_data_processing</a></code> for data format requirements.</p></dd>


<dt id="arg-library-parameters">library_parameters<a class="anchor" aria-label="anchor" href="#arg-library-parameters"></a></dt>
<dd><p>List. Library parameters with UMI_per_cell and variation.
See <code><a href="reference_data_processing.html">reference_data_processing</a></code> for parameter specifications.</p></dd>


<dt id="arg-grid-size">grid_size<a class="anchor" aria-label="anchor" href="#arg-grid-size"></a></dt>
<dd><p>Integer. Grid size for each dimension (default: 10).</p></dd>


<dt id="arg-min-power-threshold">min_power_threshold<a class="anchor" aria-label="anchor" href="#arg-min-power-threshold"></a></dt>
<dd><p>Numeric. Minimum power threshold (default: 0.01).</p></dd>


<dt id="arg-max-power-threshold">max_power_threshold<a class="anchor" aria-label="anchor" href="#arg-max-power-threshold"></a></dt>
<dd><p>Numeric. Maximum power threshold (default: 0.8).</p></dd>


<dt id="arg-mapping-efficiency">mapping_efficiency<a class="anchor" aria-label="anchor" href="#arg-mapping-efficiency"></a></dt>
<dd><p>Numeric. Mapping efficiency for raw reads to usable reads (default: 0.72).
See <code><a href="reference_data_processing.html">reference_data_processing</a></code> for typical values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame with comprehensive power analysis results across parameter combinations.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function provides comprehensive power analysis by:</p><ol><li><p>Expanding parameter combinations (TPM thresholds, fold changes)</p></li>
<li><p>Creating fold change expression data for each combination</p></li>
<li><p>Running compute_power_plan_per_grid() for each parameter set</p></li>
<li><p>Combining results into a flat dataframe for analysis</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Define parameter ranges for comprehensive analysis</span></span></span>
<span class="r-in"><span><span class="va">TPM_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">minimum_fold_change</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_per_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sequenced_reads_per_cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">25000</span>, <span class="fl">50000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get pilot data</span></span></span>
<span class="r-in"><span><span class="va">pilot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_pilot_data_from_package.html">get_pilot_data_from_package</a></span><span class="op">(</span><span class="st">"K562"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run comprehensive power analysis</span></span></span>
<span class="r-in"><span><span class="va">full_results</span> <span class="op">&lt;-</span> <span class="fu">compute_power_plan</span><span class="op">(</span></span></span>
<span class="r-in"><span>  TPM_threshold <span class="op">=</span> <span class="va">TPM_threshold</span>,</span></span>
<span class="r-in"><span>  minimum_fold_change <span class="op">=</span> <span class="va">minimum_fold_change</span>,</span></span>
<span class="r-in"><span>  cells_per_target <span class="op">=</span> <span class="va">cells_per_target</span>,</span></span>
<span class="r-in"><span>  sequenced_reads_per_cell <span class="op">=</span> <span class="va">sequenced_reads_per_cell</span>,</span></span>
<span class="r-in"><span>  baseline_expression_stats <span class="op">=</span> <span class="va">pilot_data</span><span class="op">$</span><span class="va">baseline_expression_stats</span>,</span></span>
<span class="r-in"><span>  library_parameters <span class="op">=</span> <span class="va">pilot_data</span><span class="op">$</span><span class="va">library_parameters</span>,</span></span>
<span class="r-in"><span>  MOI <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  num_targets <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  side <span class="op">=</span> <span class="st">"left"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">full_results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 81  7</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">full_results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   minimum_fold_change TPM_threshold cells_per_target num_captured_cells</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>                 0.7             5               50               512.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>                 0.7             5              100              <span style="text-decoration: underline;">1</span>025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>                 0.7             5              200              <span style="text-decoration: underline;">2</span>050 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>                 0.7             5               50               512.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>                 0.7             5              100              <span style="text-decoration: underline;">1</span>025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>                 0.7             5              200              <span style="text-decoration: underline;">2</span>050 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: sequenced_reads_per_cell &lt;dbl&gt;, library_size &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   overall_power &lt;dbl&gt;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">full_results</span><span class="op">$</span><span class="va">overall_power</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0000087 0.0035579 0.0244641 0.0968134 0.1208887 0.7185824 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziang Niu, Yihui He, Eugene Katsevich.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

