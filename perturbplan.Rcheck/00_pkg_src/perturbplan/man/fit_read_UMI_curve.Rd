% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plan_help.R
\name{fit_read_UMI_curve}
\alias{fit_read_UMI_curve}
\title{Compute effective library size from read depth using UMI saturation curve}
\usage{
fit_read_UMI_curve(reads_per_cell, UMI_per_cell, variation)
}
\arguments{
\item{reads_per_cell}{Numeric. Number of reads per cell.}

\item{UMI_per_cell}{Numeric. Total UMI per cell parameter (asymptotic maximum).}

\item{variation}{Numeric. Variation parameter characterizing PCR bias and saturation.}
}
\value{
Numeric. Effective library size (number of observed UMIs per cell).
}
\description{
This function implements the saturation-magnitude (S-M) curve to convert
read depth per cell into effective library size (observed UMIs), accounting
for PCR bias and UMI saturation effects.
}
\details{
The function implements the S-M curve model:
\deqn{UMI_{obs} = UMI_{total} \times \left(1 - \exp\left(-\frac{reads}{UMI_{total}}\right) \times \left(1 + variation \times \frac{reads^2}{2 \times UMI_{total}^2}\right)\right)}

where:
\itemize{
\item \code{UMI_obs} is the number of observed UMIs (library size)
\item \code{UMI_total} is the total number of UMIs per cell
\item \code{reads} is the number of reads per cell
\item \code{variation} accounts for PCR bias and technical variation
}
}
\seealso{
\code{\link{extract_library_info}} for obtaining the parameters
\code{\link{library_computation}} for fitting parameters from data
}
