% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{compute_distribution_teststat_random_es_cpp}
\alias{compute_distribution_teststat_random_es_cpp}
\title{Compute Test Statistic Distribution for Random Effect Sizes}
\usage{
compute_distribution_teststat_random_es_cpp(
  num_trt_cell,
  num_cntrl_cell,
  expression_mean,
  expression_size,
  avg_fold_change,
  avg_fold_change_sq
)
}
\arguments{
\item{num_trt_cell}{Numeric. Number of treatment cells}

\item{num_cntrl_cell}{Numeric. Number of control cells}

\item{expression_mean}{Numeric. Mean baseline expression level}

\item{expression_size}{Numeric. Size parameter for negative binomial distribution}

\item{avg_fold_change}{Numeric. Average fold change across perturbations}

\item{avg_fold_change_sq}{Numeric. Average of squared fold changes (second moment)}
}
\value{
A list containing:
\describe{
\item{mean}{Numeric. Asymptotic mean of the test statistic}
\item{sd}{Numeric. Asymptotic standard deviation of the test statistic}
}
}
\description{
Computes the asymptotic mean and standard deviation of the score test statistic
for random effect sizes in perturb-seq experiments. This function handles the
case where fold changes vary randomly across perturbations, using the average
fold change and its second moment.
}
\details{
This function computes the asymptotic distribution of the score test statistic
under the assumption of random effect sizes. The key difference from fixed
effect sizes is that it accounts for variability in fold changes using the
second moment (avg_fold_change_sq).

The computation follows these steps:
\enumerate{
\item Compute treatment/control cell proportions
\item Calculate treatment, control, and pooled expression means
\item Compute pooled variance using negative binomial variance formula
\item Calculate denominator squared for the test statistic
\item Compute control group variance
\item Compute treatment group variance (incorporating fold change variability)
\item Calculate final asymptotic mean and standard deviation
}
}
