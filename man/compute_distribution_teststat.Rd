% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posthoc_help.R
\name{compute_distribution_teststat}
\alias{compute_distribution_teststat}
\title{Compute asymptotic distribution of score test statistic}
\usage{
compute_distribution_teststat(
  num_trt_cells,
  num_cntrl_cells,
  num_trt_cells_sq,
  expression_mean,
  expression_size,
  fold_change_mean,
  fold_change_sd
)
}
\arguments{
\item{num_trt_cells}{Integer. Number of treatment cells in the score test.}

\item{num_cntrl_cells}{Integer. Number of control cells in the score test.}

\item{num_trt_cells_sq}{Numeric. Squared number of treatment cells (used for variance calculations).}

\item{expression_mean}{Numeric. Mean gene expression level.}

\item{expression_size}{Numeric. Size parameter in the negative binomial distribution.}

\item{fold_change_mean}{Numeric. Mean fold change effect size.}

\item{fold_change_sd}{Numeric. Standard deviation of fold change effect size.}
}
\value{
A list with elements:
\describe{
\item{mean}{Asymptotic mean of the test statistic}
\item{sd}{Asymptotic standard deviation of the test statistic}
}
}
\description{
This function computes the asymptotic mean and standard deviation of the
score test statistic used for differential expression analysis in single-cell
perturbation experiments.
}
\details{
The function computes the asymptotic distribution parameters for a score test
statistic under the negative binomial model. The calculations account for:
\itemize{
\item Random effect sizes following a normal distribution
\item Negative binomial distribution for gene expression
\item Unequal sample sizes between treatment and control groups
\item Pooled variance estimation for the denominator
}

The score test statistic follows an asymptotically normal distribution
under both null and alternative hypotheses.
}
\examples{
# Compute test statistic distribution for a specific gene
test_stat_dist <- compute_distribution_teststat(
  num_trt_cells = 400,
  num_cntrl_cells = 600,
  num_trt_cells_sq = 400^2,
  expression_mean = 12.5,  # UMIs per cell for this gene
  expression_size = 2.1,   # Dispersion parameter
  fold_change_mean = 0.8,  # Mean fold change effect
  fold_change_sd = 0.15    # SD of fold change effect
)

print(paste("Test statistic mean:", round(test_stat_dist[[1]]["mean"], 3)))
print(paste("Test statistic SD:", round(test_stat_dist[[1]]["sd"], 3)))

# Use in power calculation
cutoff <- 0.05
power <- rejection_computation(
  mean_list = test_stat_dist[[1]]["mean"],
  sd_list = test_stat_dist[[1]]["sd"],
  side = "left",
  cutoff = cutoff
)
print(paste("Individual power:", round(power, 3)))

}
\seealso{
\code{\link{var_nb}} for negative binomial variance calculation
\code{\link{rejection_computation}} for computing power from these distributions
}
