% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pilot_data_preprocessing.R
\name{pilot_data_preprocessing}
\alias{pilot_data_preprocessing}
\title{Comprehensive pilot data preprocessing from Cell Ranger output}
\usage{
pilot_data_preprocessing(
  path_to_cellranger_output,
  TPM_thres = 1,
  rough = FALSE,
  n_threads = NULL,
  downsample_ratio = 0.7,
  D2_rough = 0.3
)
}
\arguments{
\item{path_to_cellranger_output}{Character. Path to Cell Ranger output folder
containing the required subdirectories and files including:
\itemize{
\item \code{outs/filtered_feature_bc_matrix/} (matrix.mtx.gz, features.tsv.gz, barcodes.tsv.gz)
\item \code{outs/molecule_info.h5}
\item \code{outs/filtered_feature_bc_matrix.h5}
}}

\item{TPM_thres}{Numeric. TPM threshold for gene filtering (default: 1).}

\item{rough}{Logical. Whether to use rough dispersion estimation (default: FALSE).}

\item{n_threads}{Integer. Number of threads for parallel processing (default: NULL).}

\item{downsample_ratio}{Numeric. Downsampling ratio for library estimation (default: 0.7).}

\item{D2_rough}{Numeric. Initial D2 parameter estimate (default: 0.3).}
}
\value{
A list with two main elements matching the pilot_example.rds structure:
\describe{
\item{baseline_expression}{List containing:
\itemize{
\item \code{baseline_expression}: Data frame with columns \code{response_id},
\code{relative_expression}, and \code{expression_size}
\item \code{expression_dispersion_curve}: Function for predicting dispersion
from expression level
}
}
\item{library_parameters}{List containing:
\itemize{
\item \code{UMI_per_cell}: Total UMI per cell parameter
\item \code{variation}: Variation parameter characterizing PCR bias
}
}
}
}
\description{
This function performs all pilot data preprocessing steps to extract baseline
expression information and library parameters from Cell Ranger output. The output
structure matches the format expected by the perturbplan power analysis pipeline.
}
\details{
The function performs the following steps:
\enumerate{
\item Load and QC gene expression matrix using \code{\link{obtain_qc_response_data}}
\item Calculate gene expression information and dispersion using \code{\link{obtain_expression_information}}
\item Generate expression-dispersion curve using \code{\link{obtain_expression_dispersion_curve}}
\item Extract molecular information from HDF5 files using \code{\link{obtain_qc_h5_data}}
\item Estimate library parameters using \code{\link{library_estimation}}
}

The output structure is designed to be compatible with existing perturbplan functions
and matches the format of the built-in pilot data examples.
}
\seealso{
\code{\link{obtain_qc_response_data}}, \code{\link{obtain_expression_information}},
\code{\link{obtain_expression_dispersion_curve}}, \code{\link{obtain_qc_h5_data}},
\code{\link{library_estimation}}
}
