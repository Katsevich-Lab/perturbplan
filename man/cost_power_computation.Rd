% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power_plan.R
\name{cost_power_computation}
\alias{cost_power_computation}
\title{Cost-Constrained Power Analysis for Perturb-seq Experiments}
\usage{
cost_power_computation(
  minimizing_variable = "TPM_threshold",
  fixed_variable = list(minimum_fold_change = 0.8),
  MOI = 10,
  num_targets = 100,
  non_targeting_gRNAs = 10,
  gRNAs_per_target = 4,
  gRNA_variability = 0.13,
  control_group = "complement",
  side = "left",
  multiple_testing_alpha = 0.05,
  prop_non_null = 0.1,
  baseline_expression_stats,
  library_parameters,
  grid_size = 20,
  power_target = 0.8,
  power_precision = 0.01,
  min_power = 0.05,
  max_power = 0.95,
  power_range = 0.6,
  cost_precision = 0.9,
  cost_per_captured_cell = 0.086,
  cost_per_million_reads = 0.374,
  cost_constraint = NULL,
  mapping_efficiency = 0.72
)
}
\arguments{
\item{minimizing_variable}{Character. The parameter to vary during analysis.
Options: "TPM_threshold" or "minimum_fold_change". Default: "TPM_threshold".}

\item{fixed_variable}{List. Fixed values for other analysis parameters. Can include:
\itemize{
\item \code{minimum_fold_change}: Fixed fold change threshold (when varying TPM_threshold)
\item \code{TPM_threshold}: Fixed TPM threshold (when varying minimum_fold_change)
\item \code{cells_per_target}: Fixed cells per target (otherwise uses "varying")
\item \code{reads_per_cell}: Fixed reads per cell (otherwise uses "varying")
}}

\item{MOI}{Numeric. Multiplicity of infection (default: 10).}

\item{num_targets}{Integer. Number of targets (default: 100).}

\item{non_targeting_gRNAs}{Integer. Number of non-targeting gRNAs (default: 10).}

\item{gRNAs_per_target}{Integer. Number of gRNAs per target (default: 4).}

\item{gRNA_variability}{Numeric. gRNA variability parameter (default: 0.13).}

\item{control_group}{Character. Control group type: "complement" or "non_targeting" (default: "complement").}

\item{side}{Character. Test side: "left", "right", or "both" (default: "left").}

\item{multiple_testing_alpha}{Numeric. Multiple testing significance level (default: 0.05).}

\item{prop_non_null}{Numeric. Proportion of non-null hypotheses (default: 0.1).}

\item{baseline_expression_stats}{Data frame. Baseline expression statistics with columns:
\code{response_id}, \code{relative_expression}, \code{expression_size}.}

\item{library_parameters}{List. Library parameters containing \code{UMI_per_cell} and \code{variation}.}

\item{grid_size}{Integer. Grid size for parameter search (default: 20).}

\item{power_target}{Numeric. Target statistical power (default: 0.8).}

\item{power_precision}{Numeric. Acceptable precision around power target (default: 0.01).}

\item{min_power}{Numeric. Minimum power threshold for grid search (default: 0.05).}

\item{max_power}{Numeric. Maximum power threshold for grid search (default: 0.95).}

\item{power_range}{Numeric. Range around power target to search for designs (default: 0.6).
The grid search will explore designs with power between
\code{power_target - power_range/2} and \code{power_target + power_range/2},
constrained by \code{min_power} and \code{max_power}.}

\item{cost_precision}{Numeric. Cost utilization factor (default: 0.9).
Filters designs with total cost \\le cost_precision Ã— cost_constraint.}

\item{cost_per_captured_cell}{Numeric. Cost per captured cell in dollars (default: 0.086).}

\item{cost_per_million_reads}{Numeric. Cost per million sequencing reads in dollars (default: 0.374).}

\item{cost_constraint}{Numeric. Maximum budget constraint in dollars (default: NULL).
Set to \code{NULL} to disable cost constraints.}

\item{mapping_efficiency}{Numeric. Sequencing mapping efficiency (default: 0.72).}
}
\value{
Data frame with power analysis results including:
\itemize{
\item Analysis parameters (TPM_threshold, minimum_fold_change, etc.)
\item Experimental design (cells_per_target, num_captured_cells, sequenced_reads_per_cell)
\item Power metrics (overall_power)
\item Cost breakdown (library_cost, sequencing_cost, total_cost)
}
}
\description{
Performs comprehensive power analysis across experimental design space with optional
cost constraints for perturb-seq experiments. Computes power across parameter grids
and applies filtering based on power targets and budget constraints.
}
\details{
This function performs comprehensive power analysis by:
\enumerate{
\item Setting up parameter grids based on the minimizing variable
\item Computing power across experimental design space
\item Calculating costs for each design
\item Applying validation checks via \code{check_power_results()}
}

\strong{Cost Model:}

Total cost is calculated as the sum of library preparation and sequencing costs:

\code{Total Cost = Library Cost + Sequencing Cost}

Where:
\itemize{
\item \code{Library Cost = cost_per_captured_cell * num_captured_cells}
\item \code{Sequencing Cost = cost_per_million_reads * (sequenced_reads_per_cell * num_captured_cells) / 1,000,000}
}

Parameter grid generation:
\itemize{
\item \code{TPM_threshold}: Uses quantiles of baseline expression (10th to 99th percentile)
\item \code{minimum_fold_change}: Uses ranges based on test side (left: 0.5-0.9, right: 1-10, both: combined)
}
}
\keyword{internal}
