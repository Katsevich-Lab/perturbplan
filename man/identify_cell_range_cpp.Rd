% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{identify_cell_range_cpp}
\alias{identify_cell_range_cpp}
\title{Identify optimal cell count range based on power thresholds (C++)}
\usage{
identify_cell_range_cpp(
  min_reads_per_cell,
  max_reads_per_cell,
  fc_expression_df,
  UMI_per_cell,
  variation,
  MOI = 10,
  num_targets = 100L,
  gRNAs_per_target = 4L,
  non_targeting_gRNAs = 10L,
  control_group = "complement",
  multiple_testing_alpha = 0.05,
  side = "left",
  prop_non_null = 0.1,
  min_power_threshold = 0.01,
  max_power_threshold = 0.8,
  cell_lower_bound = 100,
  cell_upper_bound = 1e+05
)
}
\arguments{
\item{min_reads_per_cell}{Numeric. Minimum reads per cell from library size range}

\item{max_reads_per_cell}{Numeric. Maximum reads per cell from library size range}

\item{fc_expression_df}{DataFrame with fold change and expression info}

\item{UMI_per_cell}{Numeric. Maximum UMI per cell parameter from S-M curve}

\item{variation}{Numeric. Variation parameter from S-M curve}

\item{MOI}{Numeric. Multiplicity of infection (default 10)}

\item{num_targets}{Integer. Number of targets (default 100)}

\item{gRNAs_per_target}{Integer. gRNAs per target (default 4)}

\item{non_targeting_gRNAs}{Integer. Non-targeting gRNAs (default 10)}

\item{control_group}{String. Control group type ("complement" or "nt_cells", default "complement")}

\item{multiple_testing_alpha}{Numeric. FDR target level (default 0.05)}

\item{side}{String. Test sidedness ("left", "right", "both", default "left")}

\item{prop_non_null}{Numeric. Proportion of non-null hypotheses (default 0.1)}

\item{min_power_threshold}{Numeric. Minimum power threshold for min cells (default 0.01)}

\item{max_power_threshold}{Numeric. Target power threshold for max cells (default 0.8)}

\item{cell_lower_bound}{Numeric. Lower bound for treatment cell search (default 100)}

\item{cell_upper_bound}{Numeric. Upper bound for treatment cell search (default 1e5)}
}
\value{
List with min_cells, max_cells, and achieved power values
}
\description{
Determines minimum and maximum cell counts for power analysis using binary search.
Uses a cross-search strategy to guarantee logical ordering (min_cells <= max_cells):
finds min_cells with best-case reads and max_cells with worst-case reads.
}
\details{
This function performs two binary searches using a cross-search strategy:
\itemize{
\item Find minimum cells: Where power >= min_power_threshold using max_reads_per_cell (best-case)
\item Find maximum cells: Where power >= max_power_threshold using min_reads_per_cell (worst-case)
}

This cross-search strategy ensures min_cells <= max_cells and provides robust
experimental design ranges from minimally acceptable to well-powered studies.
}
