% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{compute_monte_carlo_teststat_new_cpp}
\alias{compute_monte_carlo_teststat_new_cpp}
\title{Compute Monte Carlo Test Statistics for Random Effect Sizes}
\usage{
compute_monte_carlo_teststat_new_cpp(
  fc_expression_df,
  library_size,
  num_trt_cells,
  num_cntrl_cells
)
}
\arguments{
\item{fc_expression_df}{DataFrame containing Monte Carlo expression samples with columns:
\itemize{
\item \code{relative_expression}: Relative expression levels
\item \code{expression_size}: Size parameters for negative binomial distribution
\item \code{avg_fold_change}: Average fold change across perturbations
\item \code{avg_fold_change_sq}: Average of squared fold changes (second moment)
}}

\item{library_size}{Numeric. Library size for scaling expression means}

\item{num_trt_cells}{Numeric. Number of treatment cells}

\item{num_cntrl_cells}{Numeric. Number of control cells}
}
\value{
A list containing:
\describe{
\item{means}{NumericVector. Asymptotic means of test statistics}
\item{sds}{NumericVector. Asymptotic standard deviations of test statistics}
}
}
\description{
Computes Monte Carlo test statistics for random effect sizes across multiple
expression samples. This function is the counterpart to compute_monte_carlo_teststat_cpp
but uses random effect sizes characterized by avg_fold_change and avg_fold_change_sq
instead of fixed fold changes.
}
\details{
This function processes Monte Carlo samples where each sample has random effect sizes
characterized by their first and second moments (avg_fold_change and avg_fold_change_sq).
It calls compute_distribution_teststat_random_es_cpp for each sample to compute the
asymptotic distribution of the test statistic.

The key difference from compute_monte_carlo_teststat_cpp is that it handles random
effect sizes rather than fixed fold changes, making it suitable for scenarios where
perturbation effects vary across cells or conditions.
}
\seealso{
\code{\link{compute_monte_carlo_teststat_cpp}} for fixed effect sizes

\code{\link{compute_distribution_teststat_random_es_cpp}} for single sample computation
}
