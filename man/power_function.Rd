% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power_posthoc.R
\name{power_function}
\alias{power_function}
\title{Compute approximate power of a CRISPR screen}
\usage{
power_function(
  recovery_rate,
  num_total_reads,
  mapping_efficiency,
  cells_per_grna,
  baseline_relative_expression_stats,
  fold_change_mean,
  fold_change_sd,
  num_planned_cells,
  control_group,
  UMI_per_cell,
  variation,
  side = "both",
  multiple_testing_method = "BH",
  multiple_testing_alpha = 0.1,
  cutoff = NULL,
  discovery_pairs,
  n_nonzero_trt_thresh = 7L,
  n_nonzero_cntrl_thresh = 7L
)
}
\arguments{
\item{recovery_rate}{A numeric value (between 0 and 1) indicating the fraction
of cells that survive and are captured after library preparation.}

\item{num_total_reads}{A numeric value specifying the total number of reads
generated by sequencing. This is used to estimate the \code{library_size}.}

\item{mapping_efficiency}{A numeric value (between 0 and 1) indicating the
fraction of reads that successfully map to the transcriptome.}

\item{cells_per_grna}{A data frame specifying the number of cells per gRNA,
with columns \code{grna_id}, \code{grna_target}, and \code{num_cells}.}

\item{baseline_relative_expression_stats}{A data frame specifying the relative
expression levels for each gene, with columns \code{response_id} and
\code{relative_expression}.}

\item{fold_change_mean}{A numeric value indicating the mean fold change effect size
for all gRNA-gene pairs (or a data frame with \code{grna_target} and \code{response_id}
columns for per-pair values).}

\item{fold_change_sd}{A numeric value indicating the standard deviation of the fold
change effect size for all gRNA-gene pairs (or a data frame with \code{grna_target}
and \code{response_id} columns for per-pair values).}

\item{num_planned_cells}{A numeric value indicating the total planned number
of cells before losses in library preparation.}

\item{control_group}{A character string specifying the control group, either
\code{"complement"} or \code{"nt_cells"}. This is passed to
\code{compute_power_posthoc}.}

\item{UMI_per_cell}{A numeric value specifying the theoretical saturation level (in UMIs)
for each cell.}

\item{variation}{A numeric value controlling how overdispersion in UMIs per read
is modeled.}

\item{side}{(Optional) A character string specifying the side of the test, either
\code{"left"}, \code{"right"}, or \code{"both"}. Defaults to \code{"both"}.}

\item{multiple_testing_method}{(Optional) A character string specifying the multiple
testing correction method, either \code{"BH"} or \code{"bonferroni"}. Defaults
to \code{"BH"}.}

\item{multiple_testing_alpha}{(Optional) A numeric value (between 0 and 1) specifying the
alpha level for multiple testing correction. Defaults to 0.1.}

\item{cutoff}{(Optional) A numeric value between 0 and 1 to use as the p-value cutoff.
If \code{NULL}, the function determines it automatically using the specified
\code{multiple_testing_method} and \code{multiple_testing_alpha}.}

\item{discovery_pairs}{A data frame specifying which gRNA-gene pairs to consider, with
columns \code{grna_target} and \code{response_id}.}

\item{n_nonzero_trt_thresh}{(Optional) An integer specifying the sceptre QC parameter
of the same name; defaults to 7.}

\item{n_nonzero_cntrl_thresh}{(Optional) An integer specifying the sceptre QC parameter
of the same name; defaults to 7.}
}
\value{
A list with two elements:
\itemize{
\item \code{individual_power}: A data frame with columns \code{grna_target},
\code{response_id}, and \code{power}, giving the power for each pair.
\item \code{expected_num_discoveries}: A numeric value indicating the expected total
number of discoveries.
}
}
\description{
This function computes the approximate power of detecting an effect (gene perturbation)
in a CRISPR screen given various experimental and sequencing parameters. Internally, it
calculates an average library size using provided parameters and estimates baseline
expression levels. The function then calls \code{\link{compute_power_posthoc}} to obtain
power estimates and the expected number of discoveries.
}
