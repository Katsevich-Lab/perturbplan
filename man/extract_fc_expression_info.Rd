% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plan_help.R
\name{extract_fc_expression_info}
\alias{extract_fc_expression_info}
\title{Extract fold change and expression information for power analysis}
\usage{
extract_fc_expression_info(
  minimum_fold_change,
  gRNA_variability,
  biological_system = "K562",
  B = 200,
  gene_list = NULL,
  TPM_threshold = 10,
  custom_pilot_data = NULL,
  gRNAs_per_target = 4
)
}
\arguments{
\item{minimum_fold_change}{Numeric. Minimum expected fold change effect (mean of gRNA effect distribution).}

\item{gRNA_variability}{Numeric. Standard deviation of gRNA effect sizes, representing variability between gRNAs targeting the same gene.}

\item{biological_system}{Character. Biological system for baseline expression. Available options:
"K562", "A549", "THP-1", "T_CD8", "iPSC" (default: "K562").}

\item{B}{Integer. Number of Monte Carlo samples to generate when gene_list is NULL (default: 200).
Ignored when gene_list is provided.}

\item{gene_list}{Character vector. Optional list of Ensembl gene IDs to use for analysis.
If provided, expression parameters will be extracted for ALL specified genes (no sampling).
If NULL (default), B genes are randomly sampled from baseline data.}

\item{TPM_threshold}{Numeric. Minimum TPM threshold (default: 10). Genes with expression
levels below TPM_threshold/1e6 are filtered out before power calculation.}

\item{custom_pilot_data}{List. Optional custom pilot data. If provided,
this data is used instead of the default biological_system data. Must contain
baseline_expression_stats (data frame with relative_expression and expression_size columns)
and library_parameters (with UMI_per_cell and variation). See
\code{\link{reference_data_preprocessing_10x}} for processing 10x Cell Ranger output and
\code{\link{reference_data_processing}} for further pilot data processing.}

\item{gRNAs_per_target}{Integer. Number of gRNAs per target (default: 4).
Each target will have gRNAs_per_target individual gRNA effect sizes drawn from the
specified fold change distribution. avg_fold_change and avg_fold_change_sq are
calculated as the mean and mean-of-squares of these gRNA effect sizes.}
}
\value{
A list with elements:
\describe{
\item{fc_expression_df}{Data frame with avg_fold_change, avg_fold_change_sq, and expression parameters}
\item{minimum_fold_change}{Numeric. The input minimum fold change for reference}
\item{pilot_data}{List. Complete pilot data object for further use}
}
}
\description{
This function combines fold change effect size sampling with baseline expression
data to create a comprehensive dataset for Monte Carlo power analysis simulations.
It can handle both user-specified genes and random sampling scenarios.
}
\details{
The function operates in two modes:
\itemize{
\item \strong{Gene-specific mode} (gene_list provided): Uses ALL specified genes, no sampling
\item \strong{Random sampling mode} (gene_list = NULL): Randomly samples B genes from baseline
}

In both modes:
\itemize{
\item Sets a random seed for reproducibility
\item Filters genes below TPM threshold (relative_expression < TPM_threshold/1e6)
\item Generates gRNAs_per_target effect sizes per target from a normal distribution
\item Calculates avg_fold_change and avg_fold_change_sq from the gRNA effect sizes
\item Returns combined data for Monte Carlo integration with random effect sizes
}
}
\examples{
# Extract fold change and expression information
fc_expr_data <- extract_fc_expression_info(
  minimum_fold_change = 0.8,
  gRNA_variability = 0.13,
  biological_system = "K562",
  B = 200,
  TPM_threshold = 10,
  gRNAs_per_target = 4
)
}
\seealso{
\code{\link{get_pilot_data_from_package}} for direct pilot data access
}
\keyword{internal}
