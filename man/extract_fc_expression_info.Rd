% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plan_help.R
\name{extract_fc_expression_info}
\alias{extract_fc_expression_info}
\title{Extract fold change and expression information for power analysis}
\usage{
extract_fc_expression_info(
  fold_change_mean,
  fold_change_sd,
  biological_system = "K562",
  B = 200,
  gene_list = NULL,
  tpm_threshold = 10
)
}
\arguments{
\item{fold_change_mean}{Numeric. Mean of the fold change distribution.}

\item{fold_change_sd}{Numeric. Standard deviation of the fold change distribution.}

\item{biological_system}{Character. Biological system for baseline expression (default: "K562").}

\item{B}{Integer. Number of Monte Carlo samples to generate when gene_list is NULL (default: 200).
Ignored when gene_list is provided.}

\item{gene_list}{Character vector. Optional list of Ensembl gene IDs to use for analysis.
If provided, expression parameters will be extracted for ALL specified genes (no sampling).
If NULL (default), B genes are randomly sampled from baseline data.}

\item{tpm_threshold}{Numeric. Minimum TPM threshold (default: 10). Genes with expression
levels below tpm_threshold/1e6 are filtered out before power calculation.}
}
\value{
A list with elements:
\describe{
\item{fc_expression_df}{Data frame with sampled fold changes and expression parameters}
\item{expression_dispersion_curve}{Function relating expression mean to dispersion}
}
}
\description{
This function combines fold change effect size sampling with baseline expression
data to create a comprehensive dataset for Monte Carlo power analysis simulations.
It can handle both user-specified genes and random sampling scenarios.
}
\details{
The function operates in two modes:
\itemize{
\item \strong{Gene-specific mode} (gene_list provided): Uses ALL specified genes, no sampling
\item \strong{Random sampling mode} (gene_list = NULL): Randomly samples B genes from baseline
}

In both modes:
\itemize{
\item Sets a random seed for reproducibility
\item Filters genes below TPM threshold (relative_expression < tpm_threshold/1e6)
\item Generates fold change values from a normal distribution (one per gene)
\item Returns combined data for Monte Carlo integration
}
}
\seealso{
\code{\link{extract_baseline_expression}} for baseline data extraction
}
