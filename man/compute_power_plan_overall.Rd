% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power_plan.R
\name{compute_power_plan_overall}
\alias{compute_power_plan_overall}
\title{Compute overall power for power analysis (core utility function)}
\usage{
compute_power_plan_overall(
  num_trt_cells,
  num_cntrl_cells,
  library_size,
  multiple_testing_alpha = 0.05,
  multiple_testing_method = "BH",
  side = "left",
  fc_expression_df,
  prop_non_null = 0.1,
  return_full_results = FALSE
)
}
\arguments{
\item{num_trt_cells}{Number of treatment cells}

\item{num_cntrl_cells}{Number of control cells}

\item{library_size}{Library size (effective UMIs per cell)}

\item{multiple_testing_alpha}{Alpha level for multiple testing (default: 0.05)}

\item{multiple_testing_method}{Multiple testing method (default: "BH")}

\item{side}{Test sidedness ("left", "right", "both", default: "left")}

\item{fc_expression_df}{Data frame with fold change and expression info}

\item{prop_non_null}{Proportion of non-null hypotheses (default: 0.1)}

\item{return_full_results}{If TRUE, return list with all intermediate results; if FALSE, return only overall power}
}
\value{
Overall power value (scalar) or list with full results depending on return_full_results
}
\description{
This function computes overall power and BH cutoff for a single experimental design.
This is a core utility function used by grid-based power analysis functions.
}
\details{
This function serves as the core power calculation utility that:
\itemize{
\item Computes test statistic distributions for each gene
\item Applies Benjamini-Hochberg multiple testing correction
\item Calculates overall statistical power
}

The function delegates to the optimized C++ implementation for performance.
}
\examples{
# Extract fold change and expression information
fc_expr_info <- extract_fc_expression_info(
  minimum_fold_change = 0.8,
  gRNA_variability = 0.13,
  biological_system = "K562",
  B = 200
)

# Get library parameters
pilot_data <- get_pilot_data_from_package("K562")
library_params <- pilot_data$library_parameters

# Calculate effective library size for 25000 reads per cell
library_size <- fit_read_UMI_curve(
  reads_per_cell = 25000,
  UMI_per_cell = library_params$UMI_per_cell,
  variation = library_params$variation
)

# Calculate power for a specific experimental design
power_result <- compute_power_plan_overall(
  fc_expression_df = fc_expr_info$fc_expression_df,
  library_size = library_size,
  num_trt_cells = 400,
  num_cntrl_cells = 600,
  multiple_testing_alpha = 0.05,
  side = "left",
  prop_non_null = 0.1
)

print(paste("Overall power:", round(power_result, 3)))

}
\keyword{internal}
