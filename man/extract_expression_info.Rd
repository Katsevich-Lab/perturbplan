% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plan_help.R
\name{extract_expression_info}
\alias{extract_expression_info}
\title{Extract baseline expression information without fold change augmentation}
\usage{
extract_expression_info(
  biological_system = "K562",
  B = 200,
  gene_list = NULL,
  TPM_threshold = 10,
  custom_pilot_data = NULL
)
}
\arguments{
\item{biological_system}{Character. Biological system for baseline expression. Available options:
"K562", "A549", "THP-1", "T_CD8", "iPSC" (default: "K562").}

\item{B}{Integer. Number of Monte Carlo samples to generate when gene_list is NULL (default: 200).
Ignored when gene_list is provided.}

\item{gene_list}{Character vector. Optional list of Ensembl gene IDs to use for analysis.
If provided, expression parameters will be extracted for ALL specified genes (no sampling).
If NULL (default), B genes are randomly sampled from baseline data.}

\item{TPM_threshold}{Numeric. Minimum TPM threshold (default: 10). Genes with expression
levels below TPM_threshold/1e6 are filtered out before power calculation.}

\item{custom_pilot_data}{List. Optional custom pilot data. If provided,
this data is used instead of the default biological_system data. Must contain
baseline_expression_stats (data frame with gene expression data)
and library_parameters (with UMI_per_cell and variation).}
}
\value{
A list with elements:
\describe{
\item{expression_df}{Data frame with baseline expression parameters (response_id, relative_expression, expression_size)}
\item{pilot_data}{Complete pilot data object for further use}
\item{n_genes}{Integer number of genes in the processed dataset}
}
}
\description{
This function extracts and processes baseline expression data for power analysis
without adding fold change parameters. It handles pilot data loading, TPM filtering,
and gene sampling. This is a modularized version of the first part of extract_fc_expression_info.
}
\details{
The function operates in two modes:
\itemize{
\item \strong{Gene-specific mode} (gene_list provided): Uses ALL specified genes with importance sampling
\item \strong{Random sampling mode} (gene_list = NULL): Randomly samples B genes from baseline
}

Processing steps:
\enumerate{
\item Load pilot data (custom or from package)
\item Apply TPM threshold filtering
\item Sample genes according to specified mode
\item Return baseline expression data ready for fold change augmentation
}
}
\examples{
# Extract expression info from K562 system
expr_info <- extract_expression_info(
  biological_system = "K562",
  B = 100,
  TPM_threshold = 5
)

# Examine the results
head(expr_info$expression_df)
print(paste("Extracted", expr_info$n_genes, "genes"))

# Use with custom gene list
gene_list <- c("ENSG00000141510", "ENSG00000157764", "ENSG00000175899")
custom_expr <- extract_expression_info(
  biological_system = "K562",
  gene_list = gene_list,
  TPM_threshold = 1
)

# Check expression levels
summary(custom_expr$expression_df$relative_expression)

}
