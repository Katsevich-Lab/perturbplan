% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pilot_data_preprocessing.R
\name{build_bio_library_info}
\alias{build_bio_library_info}
\title{Build comprehensive biological and library information from Cell Ranger output}
\usage{
build_bio_library_info(
  path_to_cellranger_output,
  multi_folder = FALSE,
  TPM_thres = 1,
  rough = FALSE,
  n_threads = NULL,
  downsample_ratio = 0.7,
  D2_rough = 0.3
)
}
\arguments{
\item{path_to_cellranger_output}{Character. Path to Cell Ranger output folder
containing the required subdirectories and files.}

\item{multi_folder}{Logical. If \code{TRUE}, process multiple SRR-named folders}

\item{TPM_thres}{Numeric. TPM threshold for gene filtering (default: 1).}

\item{rough}{Logical. Whether to use rough dispersion estimation (default: FALSE).}

\item{n_threads}{Integer. Number of threads for parallel processing (default: NULL).}

\item{downsample_ratio}{Numeric. Downsampling ratio for library estimation (default: 0.7).}

\item{D2_rough}{Numeric. Initial D2 parameter estimate (default: 0.3).}
}
\value{
A list with two main elements:
\describe{
\item{biological_system}{List containing:
\itemize{
\item \code{gene_info}: Data frame with gene expression information and dispersion
\item \code{expression_dispersion_curve}: Fitted dispersion model parameters against relative expression
}
}
\item{library_info}{List containing:
\itemize{
\item \code{S_M_curve_params}: Named numeric vector with UMI_per_cell and variation parameters
}
}
}
}
\description{
This function integrates all preprocessing steps to extract biological system
information (gene expression and dispersion) and library characteristics
from Cell Ranger output directories.
}
\details{
The function performs the following steps:
\enumerate{
\item Load and QC gene expression matrix
\item Calculate gene expression information and dispersion
\item Extract molecular information from HDF5 files
\item Estimate library parameters using saturation curve fitting
}
}
\seealso{
\code{\link{obtain_qc_response_data}}, \code{\link{obtain_expression_information}},
\code{\link{obtain_qc_h5_data}}, \code{\link{library_estimation}}
}
