% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power_plan.R
\name{compute_power_plan_per_grid}
\alias{compute_power_plan_per_grid}
\title{Compute power analysis for experimental design grid}
\usage{
compute_power_plan_per_grid(
  cells_per_target,
  reads_per_cell,
  fc_expression_df,
  library_parameters,
  grid_size = 10,
  min_power_threshold = 0.01,
  max_power_threshold = 0.8,
  MOI = 10,
  num_targets = 100,
  gRNAs_per_target = 4,
  non_targeting_gRNAs = 10,
  control_group = "complement",
  multiple_testing_alpha = 0.05,
  side = "left",
  prop_non_null = 0.1,
  mapping_efficiency = 0.72
)
}
\arguments{
\item{cells_per_target}{Numeric, numeric vector, or character. Number of cells per target, custom sequence, or "varying" for auto-generated grid.}

\item{reads_per_cell}{Numeric, numeric vector, or character. Reads per cell, custom sequence, or "varying" for auto-generated grid.}

\item{fc_expression_df}{Data frame with fold change and expression information.}

\item{library_parameters}{List containing UMI_per_cell and variation parameters.}

\item{grid_size}{Integer. Number of points in each dimension of the grid (default: 10).}

\item{min_power_threshold}{Numeric. Minimum power threshold for cell range determination (default: 0.01).}

\item{max_power_threshold}{Numeric. Maximum power threshold for cell range determination (default: 0.8).}

\item{MOI}{Numeric. Multiplicity of infection for cell allocation calculations (default: 10).}

\item{num_targets}{Integer. Number of targets for cell allocation calculations (default: 100).}

\item{gRNAs_per_target}{Integer. Number of gRNAs per target (default: 4).}

\item{non_targeting_gRNAs}{Integer. Number of non-targeting gRNAs (default: 10).}

\item{control_group}{String. Control group type: "complement" or "nt_cells" (default: "complement").}

\item{multiple_testing_alpha}{Numeric. Alpha level for multiple testing (default: 0.05).}

\item{side}{String. Test sidedness: "left", "right", or "both" (default: "left").}

\item{prop_non_null}{Numeric. Proportion of non-null hypotheses (default: 0.1).}

\item{mapping_efficiency}{Numeric. Mapping efficiency for raw reads to usable reads (default: 0.72).}
}
\value{
Data frame with columns:
\describe{
\item{cells_per_target}{Numeric. Number of treatment cells per target}
\item{reads_per_cell}{Numeric. Sequencing reads per cell}
\item{library_size}{Numeric. Effective library size (UMIs)}
\item{overall_power}{Numeric. Statistical power for this experimental design}
\item{num_captured_cells}{Numeric. Number of captured cells}
\item{sequenced_reads_per_cell}{Numeric. Raw reads per cell before mapping}
}
}
\description{
Simplified version of identify_cell_read_range that returns a clean dataframe
with experimental design combinations and their corresponding power values.
}
\details{
This function simplifies the experimental design process by:
\enumerate{
\item Determining parameter sequences based on input type:
- Numeric value: Single fixed value (length = 1)
- Numeric vector: Custom sequence (length = vector length)
- "varying": Auto-generated sequence using optimal ranges (length = grid_size)
\item Creating dynamic grids based on sequence lengths:
- Grid size = length(cells_seq) × length(reads_seq)
- Examples: 1×1 (both fixed), 5×1 (custom cells, fixed reads), 10×10 (both varying)
\item Computing power for all parameter combinations
\item Returning a clean dataframe ready for analysis
}
}
\examples{
# Extract fold change and expression information
fc_expr_info <- extract_fc_expression_info(
  minimum_fold_change = 0.8,
  gRNA_variability = 0.13,
  biological_system = "K562",
  B = 200
)

# Get library parameters
pilot_data <- get_pilot_data_from_package("K562")
library_params <- pilot_data$library_parameters

# Define experimental design grids
cells_per_target <- c(50, 100, 200)
reads_per_cell <- c(10000, 25000, 50000)

# Compute power across the grid
power_grid <- compute_power_plan_per_grid(
  cells_per_target = cells_per_target,
  reads_per_cell = reads_per_cell,
  fc_expression_df = fc_expr_info$fc_expression_df,
  library_parameters = library_params,
  MOI = 10,
  num_targets = 100,
  side = "left"
)

# View results
head(power_grid)
print(paste("Grid size:", nrow(power_grid)))

}
\keyword{internal}
