% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parameter_estimation_help.R,
%   R/pilot_data_preprocessing.R
\name{obtain_expression_information}
\alias{obtain_expression_information}
\title{Obtain gene-level expression and filtering information based on TPM.}
\usage{
obtain_expression_information(
  response_matrix,
  TPM_thres = 1,
  rough = FALSE,
  n_threads = NULL
)

obtain_expression_information(
  response_matrix,
  TPM_thres = 1,
  rough = FALSE,
  n_threads = NULL
)
}
\arguments{
\item{response_matrix}{\code{CsparseMatrix} (genes × cells).}

\item{TPM_thres}{Numeric. Filter threshold on TPM. Default \code{1}.}

\item{rough}{Logical. If \code{TRUE}, use rough C++ estimator; otherwise use
refined/MLE. Default \code{FALSE}.}

\item{n_threads}{Integer controlling parallelism:
\itemize{
\item \code{NULL} – auto-detect (prefer \env{NSLOTS}, else local cores)
\item \code{NA}   – force use of \env{NSLOTS}
\item positive integer – user-supplied core count
}}

\item{file_type}{Either "mtx" (default) or "odm", indicating the file format.}

\item{path_to_gene_expression}{Path to the folder containing expression matrix files.}

\item{cell_covariates}{A data frame of cell-level covariates (used in precomputation).}
}
\value{
A data frame with genes passing the TPM threshold, with relative expression and size parameter.

\describe{
\item{response_id}{Gene symbol passing the TPM filter}
\item{relative_expression}{Proportion of total counts}
\item{expression_size}{Estimated dispersion \eqn{\theta}}
}
}
\description{
Obtain gene-level expression and filtering information based on TPM.

Estimate gene-level dispersion (theta)
}
