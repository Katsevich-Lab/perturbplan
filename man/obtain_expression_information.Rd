% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pilot_data_preprocessing.R
\name{obtain_expression_information}
\alias{obtain_expression_information}
\title{Estimate Gene Expression Metrics from a Sparse Expression Matrix}
\usage{
obtain_expression_information(response_matrix, TPM_thres = 1, rough = FALSE)
}
\arguments{
\item{response_matrix}{A \code{CsparseMatrix} object representing gene-by-cell expression values.
Usually read with \code{Matrix::readMM()} and coerced via \code{as(., "CsparseMatrix")}.}

\item{TPM_thres}{A numeric threshold for filtering genes by TPM (Transcripts Per Million).
Genes with TPM below this value will be excluded. Default is 0.}

\item{rough}{Logical; if \code{TRUE}, use a faster but rougher estimation method for theta.
Default is \code{FALSE}.}
}
\value{
A \code{data.frame} with the following columns:
\describe{
\item{response_id}{Character vector of gene names passing the TPM threshold.}
\item{relative_expression}{Numeric vector of each gene's relative expression (as a proportion).}
\item{expression_size}{Estimated expression-size parameter \eqn{\theta} for each gene.}
}
}
\description{
This function processes a gene-by-cell sparse expression matrix (e.g., read from a \code{.mtx} file),
computes relative expression (TPM), filters genes by a TPM threshold, and estimates the
expression-size (theta) for each retained gene using a fast parallel method.
}
\details{
The theta parameter is clipped to the interval \link{0.01, 1e3} to avoid numerical instability.
}
