% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plan_help.R
\name{identify_cell_read_range}
\alias{identify_cell_read_range}
\title{Identify optimal cell and read range for power analysis with logarithmic grid generation}
\usage{
identify_cell_read_range(
  experimental_platform,
  fc_expression_info,
  library_info,
  grid_size = 10,
  min_power_threshold = 0.01,
  max_power_threshold = 0.8,
  MOI = 10,
  num_targets = 100,
  gRNAs_per_target = 4,
  non_targeting_gRNAs = 10,
  control_group = "complement",
  multiple_testing_alpha = 0.05,
  side = "left",
  prop_non_null = 0.1
)
}
\arguments{
\item{experimental_platform}{String. Experimental platform identifier for read range determination.}

\item{fc_expression_info}{List from extract_fc_expression_info() containing fc_expression_df and expression_dispersion_curve.}

\item{library_info}{List from extract_library_info() containing UMI_per_cell and variation parameters.}

\item{grid_size}{Integer. Number of points in each dimension of the grid (default: 10).}

\item{min_power_threshold}{Numeric. Minimum power threshold for cell range determination (default: 0.01).}

\item{max_power_threshold}{Numeric. Maximum power threshold for cell range determination (default: 0.8).}

\item{MOI}{Numeric. Multiplicity of infection for cell allocation calculations (default: 10).}

\item{num_targets}{Integer. Number of targets for cell allocation calculations (default: 100).}

\item{gRNAs_per_target}{Integer. Number of gRNAs per target (default: 4).}

\item{non_targeting_gRNAs}{Integer. Number of non-targeting gRNAs (default: 10).}

\item{control_group}{String. Control group type: "complement" or "nt_cells" (default: "complement").}

\item{multiple_testing_alpha}{Numeric. Alpha level for multiple testing (default: 0.05).}

\item{side}{String. Test sidedness: "left", "right", or "both" (default: "left").}

\item{prop_non_null}{Numeric. Proportion of non-null hypotheses (default: 0.1).}
}
\value{
A list containing:
\describe{
\item{cells_seq}{Numeric vector of logarithmically-spaced total cell counts}
\item{reads_seq}{Numeric vector of logarithmically-spaced reads per cell values}
\item{num_trt_cells_seq}{Numeric vector of treatment cell counts for each cell count}
\item{num_cntrl_cells_seq}{Numeric vector of control cell counts for each cell count}
\item{cell_range}{List with detailed cell range determination results}
\item{reads_range}{List with reads per cell range determination results}
\item{grid_size}{Integer grid size used}
}
}
\description{
This function combines library size range determination with cell range optimization
to generate logarithmically-spaced experimental design grids for power analysis.
It integrates identify_library_size_range_cpp() and identify_cell_range_cpp() with
treatment/control cell allocation calculations.
}
\details{
The function operates in three main steps:
\enumerate{
\item \strong{Reads Range}: Uses identify_library_size_range_cpp() to determine optimal reads per cell range based on UMI saturation curves
\item \strong{Cell Range}: Uses identify_cell_range_cpp() to determine optimal cell count range based on power thresholds
\item \strong{Grid Generation}: Creates logarithmically-spaced sequences and pre-computes treatment/control cell allocations
}

Both cell and read sequences use logarithmic spacing to provide good coverage across multiple orders of magnitude.
Treatment and control cell counts are calculated based on MOI, gRNA ratios, and control group specification.
}
\examples{
\dontrun{
# Extract required info
fc_info <- extract_fc_expression_info(0.8, 0.1, "K562", B = 100)
lib_info <- extract_library_info("K562")

# Generate experimental design
design <- identify_cell_read_range(
  experimental_platform = "10x Chromium v3",
  fc_expression_info = fc_info,
  library_info = lib_info,
  grid_size = 10
)

# Examine the design
print(design$cells_seq)      # Total cells: 100, 279, 777, ...
print(design$reads_seq)      # Reads/cell: 500, 1753, 6145, ...
print(design$num_trt_cells_seq)   # Treatment cells for each total
}

}
\seealso{
\code{\link{identify_library_size_range_cpp}} for reads per cell range determination
\code{\link{identify_cell_range_cpp}} for cell count range determination
}
